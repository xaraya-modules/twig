{# @base/includes/modifyconfig-setup.html.twig #}

{% block modifyconfig_setup %}
<fieldset>
        <legend>Version Information</legend>
        <div class="xar-row">
            <div class="xar-col">
                {% set label = 'Current Version' %}
                <label title="{{ label }}" class="xar-form-label">                            
                    Xaraya Core:                            
                </label>
            </div>
            <div class="xar-col">
                {{ constant('xarCore::VERSION_ID') }} version {{ constant('xarCore::VERSION_NUM') }} ({{ constant('xarCore::VERSION_SUB') }})
            </div>
        </div>
        <div class="xar-row">
            <div class="xar-col">
                {% set label = 'Current Build' %}
                <label title="{{ label }}" class="xar-form-label">                            
                    Git revision:                            
                </label>
            </div>
            <div class="xar-col">
                {{ xarCoreBuild }}
            </div>
        </div>
    </fieldset>
    <fieldset>
        <legend>                        
            Database Information                        
        </legend>
        <div class="xar-row">
            <div class="xar-col">
                {% set label = 'Host' %}
                <label title="{{ label }}" class="xar-form-label">                            
                    Host:                            
                </label>
            </div>
            <div class="xar-col">
                {{ xar_coremethod('xarSystemVars', 'get', constant('sys::CONFIG'), 'DB.Host') }}
            </div>
        </div>
        <div class="xar-row">
            <div class="xar-col">
                {% set label = 'Database Type' %}
                <label title="{{ label }}" class="xar-form-label">                            
                    Database Type:                            
                </label>
            </div>
            <div class="xar-col">
                {{ xar_coremethod('xarSystemVars', 'get', constant('sys::CONFIG'), 'DB.Type') }}
            </div>
        </div>
        <div class="xar-row">
            <div class="xar-col">
                {% set label = 'Current Database' %}
                <label title="{{ label }}" class="xar-form-label">                            
                    Current Database:                            
                </label>
            </div>
            <div class="xar-col">
                {% if xar_coremethod('xarSystemVars', 'get', constant('sys::CONFIG'), 'DB.Switching') %}
                    {% set value = xar_coremethod('xarSystemVars', 'get', constant('sys::CONFIG'), 'DB.Name') %}
                    {{ xar_data_input({type: "dropdown", name: "database", value: value, options: allowed_dbs}) }}
                {% else %}
                    {{ xar_coremethod('xarSystemVars', 'get', constant('sys::CONFIG'), 'DB.Name') }}
                {% endif %}
            </div>
        </div>
        <div class="xar-row">
            <div class="xar-col">
                {% set label = 'The software layer between Xaraya and its database' %}
                <label title="{{ label }}" class="xar-form-label">                            
                    Database Middleware:                            
                </label>
            </div>
            <div class="xar-col">
                {% set options = [ 
                        {'id': 'Creole', 'name': 'Creole'}, 
                        {'id': 'PDO', 'name': 'PDO'}, 
                    ] %}
                {% set value = xar_coremethod('xarSystemVars', 'get', constant('sys::CONFIG'), 'DB.Middleware') %}
                {{ xar_data_input({type: "dropdown", name: "middleware", id: "middleware", options: options, value: value}) }}
            </div>
        </div>
    </fieldset>
    <fieldset>
        <legend>                        
            Path Information                        
        </legend>
        <div class="xar-row">
            <div class="xar-col">
                {% set label = 'Web Entry Point' %}
                <label title="{{ label }}" class="xar-form-label">                            
                    Web Entry Point:                            
                </label>
            </div>
            <div class="xar-col">
                {% set value = realpaths['index.php'] %}
                {% if value == false %}
                    Cannot display this path
                {% else %}
                    {{ value }}
                {% endif %}
            </div>
        </div>
        <div class="xar-row">
            <div class="xar-col">
                {% set label = 'Bootstrap File' %}
                <label title="{{ label }}" class="xar-form-label">                            
                    Bootstrap File:                            
                </label>
            </div>
            <div class="xar-col">
                {% set value = realpaths['bootstrap.php'] %}
                {% if value == false %}
                    Cannot display this path
                {% else %}
                    {{ value }}
                {% endif %}
            </div>
        </div>
        <div class="xar-row">
            <div class="xar-col">
                {% set label = 'System Configuration File' %}
                <label title="{{ label }}" class="xar-form-label">                            
                    System Configuration File:                            
                </label>
            </div>
            <div class="xar-col">
                {% set value = realpaths['config.system.php'] %}
                {% if value == false %}
                    Cannot display this path
                {% else %}
                    {{ value }}
                {% endif %}
            </div>
        </div>
        <div class="xar-row">
            <div class="xar-col">
                {% set label = 'Log Configuration File' %}
                <label title="{{ label }}" class="xar-form-label">                            
                    Log Configuration File:                            
                </label>
            </div>
            <div class="xar-col">
                {% set value = realpaths['config.log.php'] %}
                {% if value == false %}
                    Cannot display this path
                {% else %}
                    {{ value }}
                {% endif %}
            </div>
        </div>
    </fieldset>
{% endblock %}